<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <title>AddUser</title>
  </head>
  <body>
    <h1>Add User</h1>
    <form action="#" method="POST" enctype="application/x-www-form-urlencoded">
      <div class="form-group">
        <label for="nameInput">name</label>
        <input
          type="text"
          class="form-control"
          id="nameInput"
          placeholder="Name"
        />
      </div>
      <div class="form-group">
        <label for="ageInput">Age</label>
        <input
          type="number"
          class="form-control"
          id="ageInput"
          placeholder="Age"
        />
      </div>
      <div class="checkbox">
        <label>
          <input id="policy" type="checkbox" /> You Agree All Policies
        </label>
      </div>
      <button type="submit" class="btn btn-success submitForm">Submit</button>
      <button type="cancel" class="btn btn-danger cancelForm">Cancel</button>
    </form>
    <script>
      $(() => {
        $(".cancelForm").on("click", e => {
          e.preventDefault();
          window.location.replace(
            "file:///Users/junzhuoli/HTML/Servers/jquery_crud/client/userList.html"
          );
        });
        $("form").submit(e => {
          e.preventDefault();
          if (varification()) {
            $.ajax({
              url: "http://localhost:59999/api/user/adduser",
              data: { name: $("#nameInput").val(), age: $("#ageInput").val() },
              type: "POST",
              dataType: "json",
              success: function(data) {
                console.log(data);
                window.location.replace(
                  "file:///Users/junzhuoli/HTML/Servers/jquery_crud/client/userList.html"
                );
                e.preventDefault();
              }
            });
          }
        });
      });
      let varification = () => {
        if ($("#policy").prop("checked")) {
          return true;
        } else {
          $("body").after(
            $(
              "<div style='color:red; text-align:center'>warning: please select check box</div>"
            )
          );
          return false;
        }
      };
    </script>
  </body>
</html>
